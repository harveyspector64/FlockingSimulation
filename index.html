<!DOCTYPE html>
<html>
<head>
  <title>Sheepdog Herding</title>
  <style>
    canvas {
      border: 1px solid black;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="600"></canvas>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    const sheepdog = {
      x: canvas.width / 2,
      y: canvas.height / 2,
      speed: 3,
      radius: 15,
    };

    const sheep = [];
    const numSheep = 20;
    const sheepRadius = 10;
    const sheepSpeed = 1;

    const target = {
      x: canvas.width - 100,
      y: canvas.height / 2,
      radius: 50,
    };

    // Initialize sheep
    for (let i = 0; i < numSheep; i++) {
      sheep.push({
        x: Math.random() * (canvas.width / 2),
        y: Math.random() * canvas.height,
        vx: Math.random() * 2 - 1,
        vy: Math.random() * 2 - 1,
      });
    }

    // Update function
    function update() {
      // Clear canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw target
      ctx.fillStyle = 'rgba(0, 255, 0, 0.3)';
      ctx.beginPath();
      ctx.arc(target.x, target.y, target.radius, 0, Math.PI * 2);
      ctx.fill();

      // Update sheepdog position based on mouse
      const mouseX = sheepdog.x;
      const mouseY = sheepdog.y;

      const dx = mouseX - sheepdog.x;
      const dy = mouseY - sheepdog.y;
      const distance = Math.sqrt(dx * dx + dy * dy);

      if (distance > sheepdog.speed) {
        sheepdog.x += (dx / distance) * sheepdog.speed;
        sheepdog.y += (dy / distance) * sheepdog.speed;
      }

      // Update sheep positions
      for (let i = 0; i < numSheep; i++) {
        const sheep = sheep[i];

        // Calculate distance to sheepdog
        const dx = sheepdog.x - sheep.x;
        const dy = sheepdog.y - sheep.y;
        const distance = Math.sqrt(dx * dx + dy * dy);

        // Flee from sheepdog if too close
        if (distance < 50) {
          sheep.vx -= dx / distance * sheepSpeed;
          sheep.vy -= dy / distance * sheepSpeed;
        }

        // Move towards target
        const targetDx = target.x - sheep.x;
        const targetDy = target.y - sheep.y;
        const targetDistance = Math.sqrt(targetDx * targetDx + targetDy * targetDy);

        sheep.vx += targetDx / targetDistance * sheepSpeed * 0.1;
        sheep.vy += targetDy / targetDistance * sheepSpeed * 0.1;

        // Limit sheep speed
        const speed = Math.sqrt(sheep.vx * sheep.vx + sheep.vy * sheep.vy);
        if (speed > sheepSpeed) {
          sheep.vx = (sheep.vx / speed) * sheepSpeed;
          sheep.vy = (sheep.vy / speed) * sheepSpeed;
        }

        // Update sheep position
        sheep.x += sheep.vx;
        sheep.y += sheep.vy;

        // Draw sheep
        ctx.fillStyle = 'white';
        ctx.beginPath();
        ctx.arc(sheep.x, sheep.y, sheepRadius, 0, Math.PI * 2);
        ctx.fill();
      }

      // Draw sheepdog
      ctx.fillStyle = 'brown';
      ctx.beginPath();
      ctx.arc(sheepdog.x, sheepdog.y, sheepdog.radius, 0, Math.PI * 2);
      ctx.fill();

      // Call update function again
      requestAnimationFrame(update);
    }

    // Event listener for mouse movement
    canvas.addEventListener('mousemove', (event) => {
      const rect = canvas.getBoundingClientRect();
      sheepdog.x = event.clientX - rect.left;
      sheepdog.y = event.clientY - rect.top;
    });

    // Start the game
    update();
  </script>
</body>
</html>
